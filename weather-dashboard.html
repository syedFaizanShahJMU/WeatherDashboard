<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live German Cities Weather Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .dashboard-header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 15px;
        }

        .last-updated {
            font-size: 1rem;
            opacity: 0.9;
            background: rgba(255,255,255,0.1);
            padding: 8px 16px;
            border-radius: 20px;
            display: inline-block;
        }

        .cities-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .city-card {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .city-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .city-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .city-name {
            font-size: 1.5rem;
            font-weight: bold;
        }

        .weather-icon {
            width: 50px;
            height: 50px;
        }

        .temperature {
            font-size: 3rem;
            font-weight: bold;
            margin: 10px 0;
        }

        .condition {
            font-size: 1.1rem;
            text-transform: capitalize;
            margin-bottom: 15px;
            opacity: 0.9;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }

        .detail-item {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .detail-label {
            font-size: 0.8rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .detail-value {
            font-size: 1.1rem;
            font-weight: bold;
        }

        .alert-banner {
            background: rgba(255, 193, 7, 0.9);
            color: #333;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .comparison-section {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
        }

        .comparison-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            text-align: center;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .comparison-item {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .loading {
            text-align: center;
            font-size: 1.2rem;
            padding: 50px;
        }

        .error {
            background: rgba(220, 53, 69, 0.9);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin: 20px 0;
        }

        .air-quality {
            margin-top: 10px;
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            font-size: 0.9rem;
        }

        .refresh-button {
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1rem;
            margin-left: 10px;
            transition: background 0.3s ease;
        }

        .refresh-button:hover {
            background: rgba(255,255,255,0.3);
        }

        @media (max-width: 768px) {
            .cities-grid {
                grid-template-columns: 1fr;
            }
            
            .dashboard-header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-header">
        <h1>üå§Ô∏è Live German Cities Weather</h1>
        <div class="subtitle">Real-time weather data updating every 15 minutes</div>
        <div class="last-updated" id="lastUpdated">Loading...</div>
        <button class="refresh-button" onclick="fetchWeatherData()">üîÑ Refresh Now</button>
    </div>

    <div class="alert-banner" id="alertBanner"></div>

    <div class="loading" id="loading">
        üîÑ Loading weather data for German cities...
    </div>

    <div class="cities-grid" id="citiesGrid" style="display: none;">
        <!-- Weather cards will be generated here -->
    </div>

    <div class="comparison-section" id="comparisonSection" style="display: none;">
        <div class="comparison-title">üìä Real-time City Comparison</div>
        <div class="comparison-grid" id="comparisonGrid">
            <!-- Comparison data will be generated here -->
        </div>
    </div>

    <script>
        // Your WeatherAPI.com API key
        const API_KEY = 'f474aa0ee45e41d1bd2194955251409';
        
        const cities = [
            'W√ºrzburg,Germany',
            'Frankfurt,Germany', 
            'Munich,Germany',
            'Nuremberg,Germany',
            'Stuttgart,Germany'
        ];

        let weatherData = [];

        function getTemperatureColor(temp) {
            if (temp >= 30) return '#ff4757';      // Hot - Red
            if (temp >= 25) return '#ff6b35';      // Warm - Orange
            if (temp >= 20) return '#ffc048';      // Pleasant - Yellow
            if (temp >= 15) return '#26de81';      // Cool - Green
            if (temp >= 10) return '#45aaf2';      // Cold - Blue
            if (temp >= 0) return '#a55eea';       // Very Cold - Purple
            return '#778ca3';                       // Freezing - Gray
        }

        function getAirQualityColor(usEpaIndex) {
            const colors = {
                1: '#26de81', // Good - Green
                2: '#ffc048', // Moderate - Yellow
                3: '#ff6b35', // Unhealthy for Sensitive Groups - Orange
                4: '#ff4757', // Unhealthy - Red
                5: '#8b00ff', // Very Unhealthy - Purple
                6: '#8B0000'  // Hazardous - Maroon
            };
            return colors[usEpaIndex] || '#778ca3';
        }

        function getAirQualityText(usEpaIndex) {
            const texts = {
                1: 'Good Air Quality',
                2: 'Moderate Air Quality', 
                3: 'Unhealthy for Sensitive',
                4: 'Unhealthy Air',
                5: 'Very Unhealthy Air',
                6: 'Hazardous Air'
            };
            return texts[usEpaIndex] || 'Unknown';
        }

        async function fetchWeatherData() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('citiesGrid').style.display = 'none';
            document.getElementById('comparisonSection').style.display = 'none';
            
            try {
                const promises = cities.map(async (city) => {
                    const response = await fetch(
                        `https://api.weatherapi.com/v1/current.json?key=${API_KEY}&q=${city}&aqi=yes`
                    );
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const data = await response.json();
                    
                    return {
                        name: data.location.name,
                        temp: Math.round(data.current.temp_c),
                        feelsLike: Math.round(data.current.feelslike_c),
                        humidity: data.current.humidity,
                        pressure: data.current.pressure_mb,
                        condition: data.current.condition.text,
                        windSpeed: data.current.wind_kph,
                        windDirection: data.current.wind_dir,
                        visibility: data.current.vis_km,
                        uvIndex: data.current.uv,
                        icon: data.current.condition.icon,
                        cloudiness: data.current.cloud,
                        airQuality: data.current.air_quality ? {
                            pm2_5: data.current.air_quality.pm2_5,
                            pm10: data.current.air_quality.pm10,
                            usEpaIndex: data.current.air_quality['us-epa-index']
                        } : null,
                        localTime: data.location.localtime
                    };
                });

                weatherData = await Promise.all(promises);
                updateDashboard();
                
            } catch (error) {
                showError('Failed to fetch weather data. Please check your internet connection.');
                console.error('Error fetching weather:', error);
            }
        }

        function updateDashboard() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('citiesGrid').style.display = 'grid';
            document.getElementById('comparisonSection').style.display = 'block';
            
            // Update timestamp
            document.getElementById('lastUpdated').textContent = 
                `Last Updated: ${new Date().toLocaleString('en-DE', {timeZone: 'Europe/Berlin'})}`;

            // Generate city cards
            const citiesGrid = document.getElementById('citiesGrid');
            citiesGrid.innerHTML = weatherData.map(city => `
                <div class="city-card">
                    <div class="city-header">
                        <div class="city-name">${city.name}</div>
                        <img src="https:${city.icon}" alt="${city.condition}" class="weather-icon">
                    </div>
                    <div class="temperature" style="color: ${getTemperatureColor(city.temp)};">
                        ${city.temp}¬∞C
                    </div>
                    <div class="condition">${city.condition}</div>
                    <div class="weather-details">
                        <div class="detail-item">
                            <div class="detail-label">Feels Like</div>
                            <div class="detail-value">${city.feelsLike}¬∞C</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Humidity</div>
                            <div class="detail-value">${city.humidity}%</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Wind</div>
                            <div class="detail-value">${city.windSpeed} km/h ${city.windDirection}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Visibility</div>
                            <div class="detail-value">${city.visibility} km</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">UV Index</div>
                            <div class="detail-value">${city.uvIndex}</div>
                        </div>
                        <div class="detail-item">
                            <div class="detail-label">Pressure</div>
                            <div class="detail-value">${city.pressure} mb</div>
                        </div>
                    </div>
                    ${city.airQuality ? `
                        <div class="air-quality" style="background: ${getAirQualityColor(city.airQuality.usEpaIndex)};">
                            ${getAirQualityText(city.airQuality.usEpaIndex)}
                        </div>
                    ` : ''}
                </div>
            `).join('');

            updateComparison();
            checkWeatherAlerts();
        }

        function updateComparison() {
            const temps = weatherData.map(city => city.temp);
            const hottest = weatherData.find(city => city.temp === Math.max(...temps));
            const coldest = weatherData.find(city => city.temp === Math.min(...temps));
            const avgTemp = (temps.reduce((a, b) => a + b, 0) / temps.length).toFixed(1);
            const tempDiff = Math.max(...temps) - Math.min(...temps);
            
            const humidities = weatherData.map(city => city.humidity);
            const avgHumidity = (humidities.reduce((a, b) => a + b, 0) / humidities.length).toFixed(0);

            document.getElementById('comparisonGrid').innerHTML = `
                <div class="comparison-item">
                    <div class="detail-label">üî• Hottest City</div>
                    <div class="detail-value">${hottest.name}</div>
                    <div style="font-size: 1.2rem; margin-top: 5px; color: ${getTemperatureColor(hottest.temp)};">${hottest.temp}¬∞C</div>
                </div>
                <div class="comparison-item">
                    <div class="detail-label">üßä Coldest City</div>
                    <div class="detail-value">${coldest.name}</div>
                    <div style="font-size: 1.2rem; margin-top: 5px; color: ${getTemperatureColor(coldest.temp)};">${coldest.temp}¬∞C</div>
                </div>
                <div class="comparison-item">
                    <div class="detail-label">üìä Average Temperature</div>
                    <div class="detail-value">${avgTemp}¬∞C</div>
                    <div style="font-size: 0.9rem; margin-top: 5px; opacity: 0.8;">Across all cities</div>
                </div>
                <div class="comparison-item">
                    <div class="detail-label">üìè Temperature Range</div>
                    <div class="detail-value">${tempDiff}¬∞C</div>
                    <div style="font-size: 0.9rem; margin-top: 5px; opacity: 0.8;">Difference between cities</div>
                </div>
                <div class="comparison-item">
                    <div class="detail-label">üíß Average Humidity</div>
                    <div class="detail-value">${avgHumidity}%</div>
                    <div style="font-size: 0.9rem; margin-top: 5px; opacity: 0.8;">Across all cities</div>
                </div>
                <div class="comparison-item">
                    <div class="detail-label">üå™Ô∏è Windiest City</div>
                    <div class="detail-value">${weatherData.reduce((prev, current) => (prev.windSpeed > current.windSpeed) ? prev : current).name}</div>
                    <div style="font-size: 1rem; margin-top: 5px;">${Math.max(...weatherData.map(city => city.windSpeed))} km/h</div>
                </div>
            `;
        }

        function checkWeatherAlerts() {
            const alerts = [];
            
            weatherData.forEach(city => {
                if (city.temp >= 30) alerts.push(`üî• ${city.name} is very hot (${city.temp}¬∞C)`);
                if (city.temp <= 0) alerts.push(`üßä ${city.name} is freezing (${city.temp}¬∞C)`);
                if (city.windSpeed >= 30) alerts.push(`üí® ${city.name} has strong winds (${city.windSpeed} km/h)`);
                if (city.humidity >= 90) alerts.push(`üíß ${city.name} has very high humidity (${city.humidity}%)`);
                if (city.uvIndex >= 8) alerts.push(`‚òÄÔ∏è ${city.name} has high UV levels (${city.uvIndex})`);
            });

            const alertBanner = document.getElementById('alertBanner');
            if (alerts.length > 0) {
                alertBanner.innerHTML = alerts.join(' ‚Ä¢ ');
                alertBanner.style.display = 'block';
            } else {
                alertBanner.style.display = 'none';
            }
        }

        function showError(message) {
            document.getElementById('loading').innerHTML = `
                <div class="error">
                    ‚ùå ${message}
                </div>
            `;
        }

        // Initialize dashboard
        fetchWeatherData();
        
        // Auto-refresh every 15 minutes (900,000 milliseconds)
        setInterval(fetchWeatherData, 900000);
    </script>
</body>
</html>